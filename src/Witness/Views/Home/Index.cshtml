@{
    Html.ReferenceScript("scripts/witness/SimpleRunner.coffee");
    Html.ReferenceScript("scripts/lib/jquery.js");
    Html.ReferenceScript("scripts/lib/jquery.tmpl.js");
    Html.ReferenceStylesheet("styles/witness/witness.css");
}
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Witness</title>
    @Html.RenderScripts()
    <script type="text/javascript">
        $(function () {
            var autoRun = document.location.search.match(/\bautorun=(yes|true|on|1)/i);
            var runner = new Witness.SimpleRunner("@ViewBag.Path", $("#view"), autoRun);
            runner.download();
            ko.applyBindings(runner);

            $("#run").click(function() { runner.runAll(); });

            Witness.runner = runner; // expose the runner for PhantomJS access
        });
    </script>
    @Html.RenderStylesheetLinks()
</head>
<body>
    <div id="toolbar">
        <button id="run" data-bind="enable: canRun">Run</button>
        <span data-bind="text: status"></span>
    </div>
    <div id="specifications">
        <ul data-bind="template: { name: fileSystemItemTemplate, foreach: directory }"></ul>
    </div>
    <div id="view"></div>

    <script id="directory" type="text/html">
        <li data-bind="attr: { 'class': 'directory ' + status() }, css: { open: isOpen }">
            <a class="toggle-open" href="#" data-bind="click: toggleOpen"></a>
            <div class="name" data-bind="text: name"></div>
            <ul data-bind="template: { name: 'directory', foreach: directories }"></ul>
            <ul data-bind="template: { name: fileTemplate, foreach: files }"></ul>
        </li>
    </script>
    <script id="file-of-one" type="text/html">
        <li data-bind="attr: { 'class': 'file ' + status() }, css: { open: isOpen }">
            <a class="toggle-open" href="#" data-bind="click: toggleOpen"></a>
            <div class="name">
                <span data-bind="text: specifications()[0].description"></span>
                <span class="filename" data-bind="text: '(' + name + ')'"></span>
            </div>
            <ul class="scenario-list" data-bind="template: { name: scenarioTemplate, foreach: specifications()[0].scenarios }"></ul>
            <ul data-bind="template: { name: 'error', foreach: errors }"></ul>
        </li>
    </script>
    <script id="file-of-many" type="text/html">
        <li data-bind="attr: { 'class': 'file ' + status() }, css: { open: isOpen }">
            <a class="toggle-open" href="#" data-bind="click: toggleOpen"></a>
            <div class="name" data-bind="text: name"></div>
            <ul data-bind="template: { name: 'specification', foreach: specifications }"></ul>
            <ul data-bind="template: { name: 'error', foreach: errors }"></ul>
        </li>
    </script>
    <script id="specification" type="text/html">
        <li data-bind="attr: { 'class': 'specification ' + status() }, css: { open: isOpen }">
            <a class="toggle-open" href="#" data-bind="click: toggleOpen"></a>
            <div class="name" data-bind="text: description"></div>
            <a href="#" data-bind="click: run">run</a>
            <ul class="scenario-list" data-bind="template: { name: scenarioTemplate, foreach: scenarios }"></ul>
        </li>
    </script>
    <script id="scenario" type="text/html">
        <li data-bind="attr: { 'class': 'scenario ' + status() }, click: select, css: { selected: isSelected }">
            <table data-bind="visible: givens.length">
                <thead>
                <tr>
                    <td>Given</td>
                    <td class="part-description" data-bind="text: givenDescription"></td>
                    <td class="part-toggle-container"><a class="part-toggle" href="#" data-bind="click: toggleGivens, css: { open: givensVisible }"></a></td>
                </tr>
                </thead>
                <tbody data-bind="visible: givensVisible">
                {{each givens}}
                <tr>
                    <td style="width:40px"></td>
                    <td colspan="2" data-bind="attr: { 'class': 'action ' + status() }">
                        <div data-bind="text: description"></div>
                        <ul data-bind="template: { name: 'error', foreach: errors }, visible: errors().length!=0"></ul>
                    </td>
                </tr>
                {{/each}}
                </tbody>
            </table>
            <table>
                <thead>
                <tr>
                    <td>When</td>
                    <td class="part-description" data-bind="text: whenDescription"></td>
                    <td class="part-toggle-container"><a class="part-toggle" href="#" data-bind="click: toggleWhens, css: { open: whensVisible }"></a></td>
                </tr>
                </thead>
                <tbody data-bind="visible: whensVisible">
                {{each whens}}
                <tr>
                    <td></td>
                    <td colspan="2" data-bind="attr: { 'class': 'action ' + status() }">
                        <div data-bind="text: description"></div>
                        <ul data-bind="template: { name: 'error', foreach: errors }, visible: errors().length!=0"></ul>
                    </td>
                </tr>
                {{/each}}
                </tbody>
            </table>
            <table>
                <tr>
                    <td>Then</td>
                    <td class="part-description" colspan="2" data-bind="text: thenDescription"></td>
                </tr>
                {{each thens}}
                <tr>
                    <td></td>
                    <td data-bind="attr: { 'class': 'action ' + status() }">
                        <div data-bind="text: description"></div>
                        <ul data-bind="template: { name: 'error', foreach: errors }, visible: errors().length!=0"></ul>
                    </td>
                </tr>
                {{/each}}
            </table>
            <ul data-bind="template: { name: 'error', foreach: errors }, visible: errors.length!=0"></ul>
        </li>
    </script>
    <script id="outer-scenario" type="text/html">
        <li data-bind="attr: { 'class': 'outer-scenario scenario ' + status() }, css: { open: isOpen }">
            <table>
                <thead>
                <tr>
                    <td>Given</td>
                    <td class="part-description" data-bind="text: givenDescription"></td>
                    <td class="part-toggle-container"><a class="part-toggle" href="#" data-bind="click: toggleGivens, css: { open: givensVisible }"></a></td>
                </tr>
                </thead>
                <tbody data-bind="visible: givensVisible">
                {{each givens}}
                <tr>
                    <td style="width:40px"></td>
                    <td colspan="2" data-bind="attr: { 'class': 'action ' + status() }">
                        <div data-bind="text: description"></div>
                        <ul data-bind="template: { name: 'error', foreach: errors }, visible: errors().length!=0"></ul>
                    </td>
                </tr>
                {{/each}}
                </tbody>
            </table>
            <ul data-bind="template: { name: scenarioTemplate, foreach: innerScenarios }"></ul> 
        </li>
    </script>
    <script id="action" type="text/html">
        <li data-bind="attr: { 'class': 'action ' + status() }">
            <div data-bind="text: description"></div>
            <ul data-bind="template: { name: 'error', foreach: errors }, visible: errors().length!=0"></ul>
        </li>
    </script>
    <script id="error" type="text/html">
        <li class="error" data-bind="text: message"></li>
    </script>
</body>
</html>
